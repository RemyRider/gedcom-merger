import{r as P,a as Re,R as qe}from"./react-vendor-wGySg1uH.js";import{U as he,a as W,C as _,D as Me,b as Oe,T as Te}from"./lucide-Dm3XrLvi.js";(function(){const v=document.createElement("link").relList;if(v&&v.supports&&v.supports("modulepreload"))return;for(const x of document.querySelectorAll('link[rel="modulepreload"]'))w(x);new MutationObserver(x=>{for(const N of x)if(N.type==="childList")for(const y of N.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&w(y)}).observe(document,{childList:!0,subtree:!0});function A(x){const N={};return x.integrity&&(N.integrity=x.integrity),x.referrerPolicy&&(N.referrerPolicy=x.referrerPolicy),x.crossOrigin==="use-credentials"?N.credentials="include":x.crossOrigin==="anonymous"?N.credentials="omit":N.credentials="same-origin",N}function w(x){if(x.ep)return;x.ep=!0;const N=A(x);fetch(x.href,N)}})();var xe={exports:{}},B={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $e=P,Fe=Symbol.for("react.element"),_e=Symbol.for("react.fragment"),ze=Object.prototype.hasOwnProperty,Ue=$e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,We={key:!0,ref:!0,__self:!0,__source:!0};function ue(L,v,A){var w,x={},N=null,y=null;A!==void 0&&(N=""+A),v.key!==void 0&&(N=""+v.key),v.ref!==void 0&&(y=v.ref);for(w in v)ze.call(v,w)&&!We.hasOwnProperty(w)&&(x[w]=v[w]);if(L&&L.defaultProps)for(w in v=L.defaultProps,v)x[w]===void 0&&(x[w]=v[w]);return{$$typeof:Fe,type:L,key:N,ref:y,props:x,_owner:Ue.current}}B.Fragment=_e;B.jsx=ue;B.jsxs=ue;xe.exports=B;var e=xe.exports,Q={},me=Re;Q.createRoot=me.createRoot,Q.hydrateRoot=me.hydrateRoot;const Be=()=>{const[L,v]=P.useState(null),[A,w]=P.useState([]),[x,N]=P.useState([]),[y,M]=P.useState(new Set),[D,z]=P.useState("upload"),[X,Y]=P.useState(""),[ge,fe]=P.useState(new Map),[O,pe]=P.useState(null),[l,T]=P.useState(null),[G,J]=P.useState(""),[K,Z]=P.useState(80),[U,be]=P.useState([]),[ee,$]=P.useState(0),[V,je]=P.useState(new Set),Ne="1.8.6",ye=s=>{const t=s.split(`
`),i=[],n=new Map;let r=null,m=null,c=null;return t.forEach(h=>{var u,o,f,p,g,b;const a=h.trim();if(a.startsWith("0")&&a.includes("INDI")){r&&i.push(r);const d=a.match(/@([^@]+)@/);r={id:d?d[1]:a.split(" ")[1],names:[],birth:"",birthPlace:"",death:"",deathPlace:"",sex:"",parents:[],spouses:[],familyAsChild:null,familiesAsSpouse:[],occupation:"",religion:""},c=null}else if(a.startsWith("0")&&a.includes("FAM")){const d=a.match(/@([^@]+)@/),S=d?d[1]:a.split(" ")[1];m={id:S,husband:null,wife:null,children:[]},n.set(S,m),r=null,c=null}else if(r){if(a.includes("NAME")){const d=(u=a.split("NAME")[1])==null?void 0:u.trim();d&&r.names.push(d)}else if(a.includes("SEX"))r.sex=((o=a.split("SEX")[1])==null?void 0:o.trim())||"";else if(a.startsWith("1 BIRT"))c="birth";else if(a.startsWith("1 DEAT"))c="death";else if(a.startsWith("1 OCCU"))r.occupation=((f=a.split("OCCU")[1])==null?void 0:f.trim())||"";else if(a.startsWith("1 RELI"))r.religion=((p=a.split("RELI")[1])==null?void 0:p.trim())||"";else if(c&&a.includes("DATE")){const d=((g=a.split("DATE")[1])==null?void 0:g.trim())||"";c==="birth"?r.birth=d:c==="death"&&(r.death=d)}else if(c&&a.includes("PLAC")){const d=((b=a.split("PLAC")[1])==null?void 0:b.trim())||"";c==="birth"?r.birthPlace=d:c==="death"&&(r.deathPlace=d)}else if(a.includes("FAMC")){const d=a.match(/@([^@]+)@/);d&&(r.familyAsChild=d[1])}else if(a.includes("FAMS")){const d=a.match(/@([^@]+)@/);d&&r.familiesAsSpouse.push(d[1])}a.startsWith("1 ")&&!a.startsWith("1 BIRT")&&!a.startsWith("1 DEAT")&&!a.includes("DATE")&&!a.includes("PLAC")&&(c=null)}else if(m){if(a.includes("HUSB")){const d=a.match(/@([^@]+)@/);d&&(m.husband=d[1])}else if(a.includes("WIFE")){const d=a.match(/@([^@]+)@/);d&&(m.wife=d[1])}else if(a.includes("CHIL")){const d=a.match(/@([^@]+)@/);d&&m.children.push(d[1])}}}),r&&i.push(r),i.forEach(h=>{if(h.familyAsChild){const a=n.get(h.familyAsChild);a&&(a.husband&&h.parents.push(a.husband),a.wife&&h.parents.push(a.wife))}h.familiesAsSpouse.forEach(a=>{const u=n.get(a);u&&(u.husband&&u.husband!==h.id&&h.spouses.push(u.husband),u.wife&&u.wife!==h.id&&h.spouses.push(u.wife))})}),{people:i,families:n}},E=s=>{if(!s)return"";const t=s.toLowerCase().replace(/[^a-z]/g,"");if(t.length===0)return"";let i=t.replace(/[aeiouyhw]/g,"0").replace(/[bfpv]/g,"1").replace(/[cgjkq]/g,"2").replace(/[dt]/g,"3").replace(/[l]/g,"4").replace(/[mn]/g,"5").replace(/[r]/g,"6").replace(/[sxz]/g,"7");return(t[0]+i.slice(1).replace(/(.)\1+/g,"$1").replace(/0/g,"")).substring(0,4).padEnd(4,"0")},ve=(s,t)=>{var u,o,f,p;const i=[];let n=0,r=0;const m=((u=s.names[0])==null?void 0:u.toLowerCase())||"",c=((o=t.names[0])==null?void 0:o.toLowerCase())||"";if((m||c)&&(r+=30,m&&c)){const g=E(m.split(" ")[0]),b=E(c.split(" ")[0]),d=E(m.split(" ").pop()),S=E(c.split(" ").pop());m===c?(n+=30,i.push("‚úì Noms identiques (+30/30)")):g===b&&d===S?(n+=25,i.push("‚úì Noms phon√©tiquement identiques (+25/30)")):g===b||d===S?(n+=20,i.push("‚âà Pr√©nom ou nom similaire (+20/30)")):m.includes(c)||c.includes(m)?(n+=15,i.push("‚âà Noms partiellement similaires (+15/30)")):i.push("‚úó Noms diff√©rents (0/30)")}if((s.birth||t.birth)&&(r+=25,s.birth&&t.birth)){const g=s.birth.match(/\d{4}/),b=t.birth.match(/\d{4}/);if(s.birth===t.birth)n+=25,i.push("‚úì Dates naissance identiques (+25/25)");else if(g&&b){const d=Math.abs(parseInt(g[0])-parseInt(b[0]));d===0?(n+=20,i.push("‚úì Ann√©es naissance identiques (+20/25)")):d<=2?(n+=12,i.push("‚âà Ann√©es naissance proches (+12/25)")):i.push("‚úó Dates naissance √©loign√©es (0/25)")}}if((s.sex||t.sex)&&(r+=15,s.sex&&t.sex))if(s.sex===t.sex)n+=15,i.push("‚úì M√™me sexe (+15/15)");else return i.push("‚úó Sexes diff√©rents (√âLIMINATOIRE)"),{score:0,details:i};if((s.parents.length>0||t.parents.length>0)&&(r+=20,s.parents.length>0&&t.parents.length>0)){const g=s.parents.filter(b=>t.parents.includes(b));g.length===2?(n+=20,i.push("‚úì 2 parents communs (+20/20)")):g.length===1?(n+=10,i.push("‚âà 1 parent commun (+10/20)")):i.push("‚úó Parents diff√©rents (0/20)")}if(!(s.parents.length>0&&t.parents.length>0)&&(s.familyAsChild||t.familyAsChild)&&(r+=15,s.familyAsChild&&t.familyAsChild&&(s.familyAsChild===t.familyAsChild?(n+=15,i.push("‚úì M√™me fratrie (+15/15)")):i.push("‚úó Fratries diff√©rentes (0/15)"))),s.birthPlace||t.birthPlace){r+=10;const g=(f=s.birthPlace)==null?void 0:f.toLowerCase(),b=(p=t.birthPlace)==null?void 0:p.toLowerCase();g&&b&&(g===b?(n+=10,i.push("‚úì Lieux naissance identiques (+10/10)")):i.push("‚úó Lieux naissance diff√©rents (0/10)"))}(s.spouses.length>0||t.spouses.length>0)&&(r+=8,s.spouses.length>0&&t.spouses.length>0&&(s.spouses.filter(b=>t.spouses.includes(b)).length>0?(n+=8,i.push("‚úì Conjoints communs (+8/8)")):i.push("‚úó Conjoints diff√©rents (0/8)"))),(s.death||t.death)&&(r+=15,s.death&&t.death&&(s.death===t.death?(n+=15,i.push("‚úì Dates d√©c√®s identiques (+15/15)")):i.push("‚úó Dates d√©c√®s diff√©rentes (0/15)"))),(s.occupation||t.occupation)&&(r+=5,s.occupation&&t.occupation&&(s.occupation.toLowerCase()===t.occupation.toLowerCase()?(n+=5,i.push("‚úì M√™me profession (+5/5)")):i.push("‚úó Professions diff√©rentes (0/5)")));const a=r>0?Math.round(n/r*100):0;return i.unshift(`üìä Score: ${n}/${r} points`),{score:a,details:i}},we=s=>{const t=[],i=()=>{const o=new Map,f=new Map,p=new Map;return s.forEach(g=>{var F,j;const d=(g.names[0]||"").toLowerCase().split(" "),S=d[0]||"",H=d[d.length-1]||"",I=`${E(S)}-${E(H)}`;o.has(I)||o.set(I,[]),o.get(I).push(g);const k=(j=(F=g.birth)==null?void 0:F.match(/\d{4}/))==null?void 0:j[0];if(k&&(f.has(k)||f.set(k,[]),f.get(k).push(g)),g.parents.length>0){const C=g.parents.sort().join("-");p.has(C)||p.set(C,[]),p.get(C).push(g)}}),{phoneticIndex:o,yearIndex:f,parentIndex:p}},{phoneticIndex:n,yearIndex:r,parentIndex:m}=i(),c=new Set;let h=0,a=0;s.forEach((o,f)=>{var k,F;const p=new Set,b=(o.names[0]||"").toLowerCase().split(" "),d=b[0]||"",S=b[b.length-1]||"",H=`${E(d)}-${E(S)}`;(n.get(H)||[]).forEach(j=>{j.id!==o.id&&p.add(j)});const I=(F=(k=o.birth)==null?void 0:k.match(/\d{4}/))==null?void 0:F[0];if(I){const j=parseInt(I);[-2,-1,0,1,2].forEach(C=>{const R=(j+C).toString();(r.get(R)||[]).forEach(q=>{q.id!==o.id&&p.add(q)})})}if(o.parents.length>0){const j=o.parents.sort().join("-");(m.get(j)||[]).forEach(C=>{C.id!==o.id&&p.add(C)}),o.parents.forEach(C=>{s.forEach(R=>{R.id!==o.id&&R.parents.includes(C)&&p.add(R)})})}if(p.forEach(j=>{const C=o.id<j.id?`${o.id}-${j.id}`:`${j.id}-${o.id}`;if(c.has(C)||(c.add(C),h++,!(()=>{var re,ce,de,oe;if(o.sex&&j.sex&&o.sex!==j.sex)return a++,!1;const ae=(ce=(re=o.birth)==null?void 0:re.match(/\d{4}/))==null?void 0:ce[0],le=(oe=(de=j.birth)==null?void 0:de.match(/\d{4}/))==null?void 0:oe[0];return ae&&le&&Math.abs(parseInt(ae)-parseInt(le))>5?(a++,!1):!0})()))return;const q=ve(o,j);q.score>=80&&t.push({person1:o,person2:j,similarity:Math.round(q.score),details:q.details,id:C})}),f%100===0){const j=Math.round(f/s.length*100);$(30+j*.65)}}),console.log(`Optimisation: ${h} comparaisons (${a} skipped)`),console.log(`R√©duction: ${((1-h/(s.length*(s.length-1)/2))*100).toFixed(1)}%`);const u=t.sort((o,f)=>f.similarity-o.similarity);return Pe(u,s),u},Pe=(s,t)=>{const i=new Map,n=new Set,r=[];s.forEach(c=>{const h=c.person1.id,a=c.person2.id;i.has(h)||i.set(h,new Set),i.has(a)||i.set(a,new Set),i.get(h).add(a),i.get(a).add(h)});const m=(c,h)=>{if(n.has(c))return;n.add(c),h.add(c),(i.get(c)||new Set).forEach(u=>m(u,h))};i.forEach((c,h)=>{if(!n.has(h)){const a=new Set;if(m(h,a),a.size>2){const u=Array.from(a),o=u.map(f=>t.find(p=>p.id===f)).filter(f=>f!=null);o.length>2&&r.push({ids:u,size:o.length,people:o})}}}),console.log("Clusters d√©tect√©s:",r.length,r),be(r)},Ce=s=>{const t=new Set(y);x.forEach(i=>{s.includes(i.person1.id)&&s.includes(i.person2.id)&&t.add(i.id)}),M(t)},Se=s=>{const t=new Set(V);t.has(s)?t.delete(s):t.add(s),je(t)},se=s=>{var i;let t=0;return((i=s.names[0])==null?void 0:i.length)>5&&(t+=10),s.birth&&(t+=8),s.death&&(t+=6),s.sex&&(t+=4),s.birthPlace&&(t+=7),s.deathPlace&&(t+=5),t+=s.parents.length*6,t+=s.spouses.length*5,s.occupation&&(t+=4),s.religion&&(t+=2),s.familyAsChild&&(t+=3),t+=s.familiesAsSpouse.length*3,t},Ae=(s,t)=>{const i={...s};return!i.birth&&t.birth&&(i.birth=t.birth),!i.birthPlace&&t.birthPlace&&(i.birthPlace=t.birthPlace),!i.death&&t.death&&(i.death=t.death),!i.deathPlace&&t.deathPlace&&(i.deathPlace=t.deathPlace),!i.sex&&t.sex&&(i.sex=t.sex),!i.occupation&&t.occupation&&(i.occupation=t.occupation),!i.religion&&t.religion&&(i.religion=t.religion),t.names.forEach(n=>{i.names.includes(n)||i.names.push(n)}),t.parents.forEach(n=>{i.parents.includes(n)||i.parents.push(n)}),t.spouses.forEach(n=>{i.spouses.includes(n)||i.spouses.push(n)}),!i.familyAsChild&&t.familyAsChild&&(i.familyAsChild=t.familyAsChild),t.familiesAsSpouse.forEach(n=>{i.familiesAsSpouse.includes(n)||i.familiesAsSpouse.push(n)}),i},Ee=s=>{const t=se(s.person1),i=se(s.person2),n=t>=i?s.person1:s.person2,r=n===s.person1?s.person2:s.person1,m=Ae(n,r);T({original:s,keepPerson:n,removePerson:r,merged:m,quality1:t,quality2:i})},ke=s=>{const t=s.target.files[0];if(!t)return;z("analyzing"),$(0);const i=new FileReader;i.onload=n=>{const r=n.target.result;Y(r),setTimeout(()=>{const{people:m}=ye(r);w(m),$(30),setTimeout(()=>{const c=we(m);N(c),$(100),setTimeout(()=>z("review"),500)},100)},100)},i.readAsText(t)},te=s=>{const t=new Set(y);t.has(s)?t.delete(s):t.add(s),M(t)},Le=()=>{const s=x.filter(t=>t.similarity>=95).map(t=>t.id);M(new Set(s))},ie=()=>{let s=x.filter(t=>t.similarity>=K);if(G.trim()){const t=G.toLowerCase();s=s.filter(i=>{var n,r;return((n=i.person1.names[0])==null?void 0:n.toLowerCase().includes(t))||((r=i.person2.names[0])==null?void 0:r.toLowerCase().includes(t))})}return s},De=()=>{const s=new Map;y.forEach(i=>{const n=x.find(r=>r.id===i);if(n){const r=n.person1.id,m=n.person2.id;let c=r;s.has(r)?c=s.get(r):s.has(m)&&(c=s.get(m)),s.set(r,c),s.set(m,c)}}),fe(s);const t=new Set;s.forEach((i,n)=>{n!==i&&t.add(n)}),pe({totalIndividuals:A.length,mergedCount:t.size,remainingCount:A.length-t.size}),z("merged")},Ie=()=>{if(!X)return;const s=new Set,t=new Map;ge.forEach((a,u)=>{u!==a&&(s.add(u),t.set(u,a))});const i=X.split(`
`),n=[];let r=!1;for(let a=0;a<i.length;a++){const u=i[a],o=u.trim();if(o.startsWith("0 ")&&(r=!1,o.includes("@"))){const p=o.match(/@([^@]+)@/);if(p&&s.has(p[1])){r=!0;continue}}if(r)continue;let f=u;t.forEach((p,g)=>{f=f.replace(new RegExp(`@${g}@`,"g"),`@${p}@`)}),n.push(f)}const m=new Blob([n.join(`
`)],{type:"text/plain"}),c=URL.createObjectURL(m),h=document.createElement("a");h.href=c,h.download=`gedcom_nettoye_${new Date().toISOString().slice(0,10)}.ged`,document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL(c)},ne=()=>{z("upload"),w([]),N([]),M(new Set),Y(""),J(""),Z(80),$(0)};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-8",children:e.jsx("div",{className:"max-w-6xl mx-auto",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-indigo-600 to-blue-500 p-8 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(he,{className:"w-12 h-12"}),e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("h1",{className:"text-3xl font-bold",children:["Fusionneur GEDCOM v",Ne]})}),e.jsx("p",{className:"text-indigo-100 mt-2",children:"Nettoyez votre arbre g√©n√©alogique"})]})]}),(D==="review"||D==="merged")&&e.jsxs("button",{onClick:ne,className:"bg-white/10 hover:bg-white/20 px-4 py-2 rounded-lg transition-colors flex items-center gap-2",children:[e.jsx(W,{className:"w-5 h-5"}),"Nouveau"]})]})}),e.jsxs("div",{className:"p-8",children:[D==="upload"&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(W,{className:"w-24 h-24 mx-auto text-indigo-400 mb-6"}),e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"T√©l√©chargez votre fichier GEDCOM"}),e.jsxs("label",{children:[e.jsx("input",{type:"file",accept:".ged",onChange:ke,className:"hidden"}),e.jsxs("div",{className:"bg-indigo-600 hover:bg-indigo-700 text-white px-8 py-4 rounded-lg cursor-pointer inline-flex items-center gap-3 transition-colors",children:[e.jsx(W,{className:"w-6 h-6"}),"Choisir un fichier"]})]})]}),D==="analyzing"&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin w-16 h-16 border-4 border-indigo-200 border-t-indigo-600 rounded-full mx-auto mb-6"}),e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Analyse en cours..."}),e.jsx("div",{className:"w-full max-w-md mx-auto bg-gray-200 rounded-full h-4",children:e.jsx("div",{className:"bg-indigo-600 h-4 rounded-full transition-all",style:{width:`${ee}%`}})}),e.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:[ee,"%"]})]}),D==="review"&&e.jsxs("div",{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-2",children:"Doublons d√©tect√©s"}),e.jsxs("p",{className:"text-gray-600",children:[x.length," doublon(s) trouv√©(s)"]})]}),x.length>0&&e.jsxs(e.Fragment,{children:[U.length>0&&e.jsxs("div",{className:"mb-6 bg-orange-50 border-2 border-orange-300 rounded-lg p-4",children:[e.jsxs("h3",{className:"font-semibold text-orange-900 mb-3 flex items-center gap-2",children:[e.jsx(he,{className:"w-5 h-5"}),"üîó ",U.length," cluster(s) de doublons d√©tect√©(s)"]}),e.jsxs("p",{className:"text-sm text-orange-700 mb-3",children:["Des groupes de ",U.reduce((s,t)=>s+t.size,0)," personnes connect√©es ont √©t√© identifi√©s (triplets, quadruplets...)."]}),e.jsx("div",{className:"space-y-3",children:U.map((s,t)=>e.jsxs("div",{className:"bg-white border-2 border-orange-300 rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4 mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs("span",{className:"font-bold text-orange-900",children:["Cluster ",t+1]}),e.jsxs("span",{className:"bg-orange-200 text-orange-800 px-2 py-1 rounded-full text-xs font-bold",children:[s.size," personnes"]})]}),e.jsx("p",{className:"text-xs text-gray-600 mb-2",children:"Toutes ces personnes sont li√©es entre elles par des correspondances"})]}),e.jsxs("button",{onClick:()=>Ce(s.ids),className:"bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors whitespace-nowrap flex items-center gap-2",children:[e.jsx(_,{className:"w-4 h-4"}),"S√©lectionner tout"]})]}),e.jsx("div",{className:"bg-orange-50 rounded-lg p-3 mb-2",children:e.jsxs("div",{className:"text-sm text-gray-700 space-y-1",children:[s.people.slice(0,3).map((i,n)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 bg-orange-400 rounded-full flex-shrink-0"}),e.jsx("span",{className:"font-medium",children:i.names[0]||"Sans nom"}),i.birth&&e.jsxs("span",{className:"text-gray-500 text-xs",children:["(",i.birth,")"]}),e.jsx("span",{className:"text-xs text-gray-400 font-mono",children:i.id})]},n)),s.people.length>3&&e.jsxs("div",{className:"text-xs text-gray-500 italic ml-4",children:["... et ",s.people.length-3," autre(s)"]})]})}),e.jsx("button",{onClick:()=>Se(t),className:"w-full text-center text-sm text-orange-700 hover:text-orange-900 font-medium py-2 hover:bg-orange-50 rounded transition-colors",children:V.has(t)?"‚ñ≤ Masquer les d√©tails":"‚ñº Voir tous les membres du cluster"})]}),V.has(t)&&e.jsxs("div",{className:"border-t-2 border-orange-200 bg-gray-50 p-4",children:[e.jsx("h5",{className:"font-semibold text-gray-700 mb-3",children:"üìä R√©sum√© du cluster :"}),e.jsx("div",{className:"bg-white border border-gray-300 rounded-lg overflow-hidden mb-3",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-orange-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left font-semibold text-gray-700",children:"#"}),e.jsx("th",{className:"px-3 py-2 text-left font-semibold text-gray-700",children:"Nom complet"}),e.jsx("th",{className:"px-3 py-2 text-left font-semibold text-gray-700",children:"Naissance"}),e.jsx("th",{className:"px-3 py-2 text-left font-semibold text-gray-700",children:"D√©c√®s"}),e.jsx("th",{className:"px-3 py-2 text-left font-semibold text-gray-700",children:"ID"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:s.people.map((i,n)=>e.jsxs("tr",{className:"hover:bg-orange-50",children:[e.jsx("td",{className:"px-3 py-2",children:e.jsx("span",{className:"bg-orange-500 text-white text-xs font-bold rounded-full w-6 h-6 flex items-center justify-center",children:n+1})}),e.jsx("td",{className:"px-3 py-2 font-medium text-gray-900",children:i.names[0]||"Sans nom"}),e.jsx("td",{className:"px-3 py-2 text-gray-600",children:i.birth||"-"}),e.jsx("td",{className:"px-3 py-2 text-gray-600",children:i.death||"-"}),e.jsx("td",{className:"px-3 py-2 text-xs text-gray-500 font-mono",children:i.id})]},n))})]})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-xs",children:[e.jsxs("div",{className:"bg-white rounded p-2 border border-gray-200",children:[e.jsx("div",{className:"text-gray-500",children:"Personnes"}),e.jsx("div",{className:"text-lg font-bold text-orange-600",children:s.size})]}),e.jsxs("div",{className:"bg-white rounded p-2 border border-gray-200",children:[e.jsx("div",{className:"text-gray-500",children:"Avec naissance"}),e.jsx("div",{className:"text-lg font-bold text-blue-600",children:s.people.filter(i=>i.birth).length})]}),e.jsxs("div",{className:"bg-white rounded p-2 border border-gray-200",children:[e.jsx("div",{className:"text-gray-500",children:"Avec d√©c√®s"}),e.jsx("div",{className:"text-lg font-bold text-purple-600",children:s.people.filter(i=>i.death).length})]}),e.jsxs("div",{className:"bg-white rounded p-2 border border-gray-200",children:[e.jsx("div",{className:"text-gray-500",children:"Avec parents"}),e.jsx("div",{className:"text-lg font-bold text-green-600",children:s.people.filter(i=>i.parents.length>0).length})]})]})]})]},t))})]}),e.jsxs("div",{className:"mb-6 bg-white border-2 border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Rechercher"}),e.jsx("input",{type:"text",value:G,onChange:s=>J(s.target.value),placeholder:"Nom ou ID",className:"w-full px-4 py-2 border rounded-lg"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Score min: ",K,"%"]}),e.jsx("input",{type:"range",min:"80",max:"100",value:K,onChange:s=>Z(parseInt(s.target.value)),className:"w-full"})]})]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-3",children:[ie().length," r√©sultat(s)"]})]}),e.jsxs("div",{className:"mb-6 flex gap-4 flex-wrap",children:[e.jsx("button",{onClick:Le,className:"bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-2 rounded-lg font-medium",children:"S√©lectionner ‚â•95%"}),e.jsx("button",{onClick:()=>M(new Set),className:"bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg font-medium",children:"D√©s√©lectionner tout"}),e.jsxs("span",{className:"text-sm text-gray-600 py-2",children:[y.size," s√©lectionn√©(s)"]})]}),e.jsx("div",{className:"space-y-4",children:ie().map(s=>e.jsxs("div",{className:`border-2 rounded-lg p-6 cursor-pointer ${y.has(s.id)?"border-indigo-500 bg-indigo-50":"border-gray-200"}`,onClick:()=>te(s.id),children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",checked:y.has(s.id),onChange:()=>{},className:"w-5 h-5"}),e.jsxs("span",{className:"font-semibold",children:["Similarit√©: ",s.similarity,"%"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:t=>{t.stopPropagation(),Ee(s)},className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2",children:"üëÅÔ∏è Pr√©visualiser"}),e.jsx("div",{className:`px-4 py-2 rounded-full text-sm font-medium ${s.similarity>=95?"bg-red-100 text-red-800":s.similarity>=90?"bg-orange-100 text-orange-800":"bg-yellow-100 text-yellow-800"}`,children:s.similarity>=95?"Tr√®s probable":s.similarity>=90?"Probable":"Possible"})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white p-4 rounded border",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Personne 1"}),e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"Nom:"})," ",s.person1.names[0]]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"Naissance:"})," ",s.person1.birth||"N/A"]}),s.person1.birthPlace&&e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"Lieu:"})," ",s.person1.birthPlace]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"D√©c√®s:"})," ",s.person1.death||"N/A"]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"Sexe:"})," ",s.person1.sex||"N/A"]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"Parents:"})," ",s.person1.parents.length>0?s.person1.parents.map(t=>{const i=A.find(n=>n.id===t);return(i==null?void 0:i.names[0])||t}).join(", "):"N/A"]}),e.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["ID: ",s.person1.id]})]}),e.jsxs("div",{className:"bg-white p-4 rounded border",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Personne 2"}),e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"Nom:"})," ",s.person2.names[0]]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"Naissance:"})," ",s.person2.birth||"N/A"]}),s.person2.birthPlace&&e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"Lieu:"})," ",s.person2.birthPlace]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"D√©c√®s:"})," ",s.person2.death||"N/A"]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"Sexe:"})," ",s.person2.sex||"N/A"]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"Parents:"})," ",s.person2.parents.length>0?s.person2.parents.map(t=>{const i=A.find(n=>n.id===t);return(i==null?void 0:i.names[0])||t}).join(", "):"N/A"]}),e.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["ID: ",s.person2.id]})]})]}),s.details&&s.details.length>0&&e.jsxs("div",{className:"mt-4 pt-4 border-t",children:[e.jsx("p",{className:"text-xs font-medium text-gray-600 mb-2",children:"üéØ Crit√®res de correspondance:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.details.map((t,i)=>e.jsx("span",{className:"text-xs bg-indigo-100 text-indigo-700 px-2 py-1 rounded",children:t},i))})]})]},s.id))}),y.size>0&&e.jsx("div",{className:"fixed bottom-8 right-8",children:e.jsxs("button",{onClick:De,className:"bg-green-600 hover:bg-green-700 text-white px-8 py-4 rounded-full font-bold shadow-2xl flex items-center gap-2",children:[e.jsx(_,{className:"w-6 h-6"}),"Fusionner ",(()=>{const s=new Set;return y.forEach(t=>{const i=x.find(n=>n.id===t);i&&(s.add(i.person1.id),s.add(i.person2.id))}),s.size})()," personne",(()=>{const s=new Set;return y.forEach(t=>{const i=x.find(n=>n.id===t);i&&(s.add(i.person1.id),s.add(i.person2.id))}),s.size>1?"s":""})()]})})]})]}),D==="merged"&&O&&e.jsxs("div",{className:"text-center",children:[e.jsx(_,{className:"w-24 h-24 mx-auto text-green-500 mb-6"}),e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Fusion termin√©e !"}),e.jsxs("p",{className:"text-gray-600 mb-8",children:[O.mergedCount," doublon(s) fusionn√©(s)"]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4 mb-8",children:[e.jsxs("div",{className:"bg-blue-50 border-l-4 border-blue-500 p-4",children:[e.jsx("div",{className:"text-sm text-blue-600",children:"Original"}),e.jsx("div",{className:"text-2xl font-bold",children:O.totalIndividuals})]}),e.jsxs("div",{className:"bg-red-50 border-l-4 border-red-500 p-4",children:[e.jsx("div",{className:"text-sm text-red-600",children:"Supprim√©s"}),e.jsx("div",{className:"text-2xl font-bold",children:O.mergedCount})]}),e.jsxs("div",{className:"bg-green-50 border-l-4 border-green-500 p-4",children:[e.jsx("div",{className:"text-sm text-green-600",children:"Restants"}),e.jsx("div",{className:"text-2xl font-bold",children:O.remainingCount})]})]}),e.jsxs("div",{className:"flex gap-4 justify-center",children:[e.jsxs("button",{onClick:Ie,className:"bg-green-600 hover:bg-green-700 text-white px-8 py-3 rounded-lg font-medium inline-flex items-center gap-2",children:[e.jsx(Me,{className:"w-5 h-5"}),"T√©l√©charger"]}),e.jsxs("button",{onClick:ne,className:"bg-indigo-600 hover:bg-indigo-700 text-white px-8 py-3 rounded-lg font-medium inline-flex items-center gap-2",children:[e.jsx(W,{className:"w-5 h-5"}),"Nouveau fichier"]})]})]}),l&&e.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4",onClick:()=>T(null),children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-6xl w-full max-h-[90vh] overflow-y-auto",onClick:s=>s.stopPropagation(),children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white p-6 sticky top-0 z-10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold flex items-center gap-2",children:"üëÅÔ∏è Pr√©visualisation de la fusion"}),e.jsxs("p",{className:"text-blue-100 text-sm mt-1",children:["Score: ",l.original.similarity,"% - Voir le r√©sultat avant de fusionner"]})]}),e.jsx("button",{onClick:()=>T(null),className:"bg-white/20 hover:bg-white/30 w-10 h-10 rounded-full flex items-center justify-center transition-colors text-2xl",children:"‚úï"})]})}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"bg-blue-50 border-l-4 border-blue-500 p-4 rounded",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Oe,{className:"w-5 h-5 text-blue-600 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"text-sm text-blue-900 font-medium",children:["L'ID ",e.jsx("span",{className:"font-mono bg-blue-100 px-2 py-0.5 rounded",children:l.keepPerson.id})," sera conserv√© (score qualit√©: ",l.quality1>=l.quality2?l.quality1:l.quality2," points)"]}),e.jsx("p",{className:"text-xs text-blue-700 mt-1",children:"Les donn√©es manquantes seront automatiquement compl√©t√©es avec celles de l'autre personne"})]})]})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg text-gray-800 mb-3",children:"üìä Avant fusion"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"border-2 border-green-500 rounded-lg bg-green-50 p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(_,{className:"w-5 h-5 text-green-600"}),e.jsx("h4",{className:"font-bold text-green-900",children:"Conserv√©"}),e.jsxs("span",{className:"text-xs bg-green-200 text-green-800 px-2 py-1 rounded",children:["Qualit√©: ",l.quality1>=l.quality2?l.quality1:l.quality2]})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"ID:"})," ",l.keepPerson.id]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Nom:"})," ",l.keepPerson.names[0]||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Naissance:"})," ",l.keepPerson.birth||"N/A"]}),l.keepPerson.birthPlace&&e.jsxs("p",{children:[e.jsx("strong",{children:"Lieu:"})," ",l.keepPerson.birthPlace]}),e.jsxs("p",{children:[e.jsx("strong",{children:"D√©c√®s:"})," ",l.keepPerson.death||"N/A"]}),l.keepPerson.deathPlace&&e.jsxs("p",{children:[e.jsx("strong",{children:"Lieu:"})," ",l.keepPerson.deathPlace]}),l.keepPerson.occupation&&e.jsxs("p",{children:[e.jsx("strong",{children:"Profession:"})," ",l.keepPerson.occupation]})]})]}),e.jsxs("div",{className:"border-2 border-red-500 rounded-lg bg-red-50 p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(Te,{className:"w-5 h-5 text-red-600"}),e.jsx("h4",{className:"font-bold text-red-900",children:"Supprim√©"}),e.jsxs("span",{className:"text-xs bg-red-200 text-red-800 px-2 py-1 rounded",children:["Qualit√©: ",l.quality1<l.quality2?l.quality1:l.quality2]})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"ID:"})," ",l.removePerson.id]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Nom:"})," ",l.removePerson.names[0]||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Naissance:"})," ",l.removePerson.birth||"N/A"]}),l.removePerson.birthPlace&&e.jsxs("p",{children:[e.jsx("strong",{children:"Lieu:"})," ",l.removePerson.birthPlace]}),e.jsxs("p",{children:[e.jsx("strong",{children:"D√©c√®s:"})," ",l.removePerson.death||"N/A"]}),l.removePerson.deathPlace&&e.jsxs("p",{children:[e.jsx("strong",{children:"Lieu:"})," ",l.removePerson.deathPlace]}),l.removePerson.occupation&&e.jsxs("p",{children:[e.jsx("strong",{children:"Profession:"})," ",l.removePerson.occupation]})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg text-gray-800 mb-3",children:"‚ú® Apr√®s fusion (r√©sultat enrichi)"}),e.jsx("div",{className:"border-2 border-indigo-500 rounded-lg bg-indigo-50 p-6",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-semibold text-gray-700 w-32",children:"ID:"}),e.jsx("span",{className:"font-mono",children:l.merged.id})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-semibold text-gray-700 w-32",children:"Nom(s):"}),e.jsx("div",{className:"flex-1",children:l.merged.names.map((s,t)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:s}),t>0&&e.jsx("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded",children:"Ajout√©"})]},t))})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-semibold text-gray-700 w-32",children:"Naissance:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:l.merged.birth||"N/A"}),!l.keepPerson.birth&&l.removePerson.birth&&e.jsx("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded",children:"Ajout√©"})]})]}),l.merged.birthPlace&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-semibold text-gray-700 w-32",children:"Lieu naissance:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:l.merged.birthPlace}),!l.keepPerson.birthPlace&&l.removePerson.birthPlace&&e.jsx("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded",children:"Ajout√©"})]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-semibold text-gray-700 w-32",children:"D√©c√®s:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:l.merged.death||"N/A"}),!l.keepPerson.death&&l.removePerson.death&&e.jsx("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded",children:"Ajout√©"})]})]}),l.merged.deathPlace&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-semibold text-gray-700 w-32",children:"Lieu d√©c√®s:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:l.merged.deathPlace}),!l.keepPerson.deathPlace&&l.removePerson.deathPlace&&e.jsx("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded",children:"Ajout√©"})]})]}),l.merged.occupation&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-semibold text-gray-700 w-32",children:"Profession:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:l.merged.occupation}),!l.keepPerson.occupation&&l.removePerson.occupation&&e.jsx("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded",children:"Ajout√©"})]})]})]})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[e.jsx("button",{onClick:()=>T(null),className:"px-6 py-2 border-2 border-gray-300 rounded-lg font-medium hover:bg-gray-50 transition-colors",children:"Fermer"}),e.jsxs("button",{onClick:()=>{te(l.original.id),T(null)},className:`px-6 py-2 rounded-lg font-medium transition-colors flex items-center gap-2 ${y.has(l.original.id)?"bg-red-600 hover:bg-red-700 text-white":"bg-green-600 hover:bg-green-700 text-white"}`,children:[e.jsx(_,{className:"w-5 h-5"}),y.has(l.original.id)?"D√©s√©lectionner":"S√©lectionner pour fusion"]})]})]})]})})]})]})})})};Q.createRoot(document.getElementById("root")).render(e.jsx(qe.StrictMode,{children:e.jsx(Be,{})}));
