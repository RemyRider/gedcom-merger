import{r as j,a as as,R as ns}from"./react-vendor-DghaKJPf.js";import{U as is,R as rs,S as De,a as Le,b as Re,A as W,C as ls,c as cs,T as os,B as ds,d as re,D as hs}from"./lucide-BIN9RVCf.js";(function(){const v=document.createElement("link").relList;if(v&&v.supports&&v.supports("modulepreload"))return;for(const p of document.querySelectorAll('link[rel="modulepreload"]'))C(p);new MutationObserver(p=>{for(const y of p)if(y.type==="childList")for(const N of y.addedNodes)N.tagName==="LINK"&&N.rel==="modulepreload"&&C(N)}).observe(document,{childList:!0,subtree:!0});function E(p){const y={};return p.integrity&&(y.integrity=p.integrity),p.referrerPolicy&&(y.referrerPolicy=p.referrerPolicy),p.crossOrigin==="use-credentials"?y.credentials="include":p.crossOrigin==="anonymous"?y.credentials="omit":y.credentials="same-origin",y}function C(p){if(p.ep)return;p.ep=!0;const y=E(p);fetch(p.href,y)}})();var Te={exports:{}},Q={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ms=j,xs=Symbol.for("react.element"),us=Symbol.for("react.fragment"),gs=Object.prototype.hasOwnProperty,fs=ms.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ps={key:!0,ref:!0,__self:!0,__source:!0};function Ie(T,v,E){var C,p={},y=null,N=null;E!==void 0&&(y=""+E),v.key!==void 0&&(y=""+v.key),v.ref!==void 0&&(N=v.ref);for(C in v)gs.call(v,C)&&!ps.hasOwnProperty(C)&&(p[C]=v[C]);if(T&&T.defaultProps)for(C in v=T.defaultProps,v)p[C]===void 0&&(p[C]=v[C]);return{$$typeof:xs,type:T,key:y,ref:N,props:p,_owner:fs.current}}Q.Fragment=us;Q.jsx=Ie;Q.jsxs=Ie;Te.exports=Q;var e=Te.exports,le={},$e=as;le.createRoot=$e.createRoot,le.hydrateRoot=$e.hydrateRoot;const js=()=>{const[T,v]=j.useState(null),[E,C]=j.useState([]),[p,y]=j.useState([]),[N,k]=j.useState(new Set),[q,X]=j.useState("upload"),[ce,oe]=j.useState(""),[de,he]=j.useState(new Map),[$,me]=j.useState(null),[R,ee]=j.useState(null),[B,xe]=j.useState(""),[M,ue]=j.useState(80),[U,ge]=j.useState([]),[G,I]=j.useState(0),[se,fe]=j.useState(new Set),[_e,pe]=j.useState(!1),[O,je]=j.useState("clusters"),[F,be]=j.useState(80),[ke,ye]=j.useState(new Set),[_,Ne]=j.useState([]),[A,H]=j.useState(new Set),[V,ve]=j.useState([]),[u,we]=j.useState(null),[Me,Ce]=j.useState(new Map),[Oe,K]=j.useState(!1),Se="1.9.4",Ee=[{version:"1.9.4",date:"30 d√©cembre 2025",tag:"ACTUELLE",color:"green",title:"Affichage complet + Contr√¥le int√©grit√© avanc√©",items:["Affichage d√©tails complet dans Suggestions IA (r√©gression v1.7.2 corrig√©e)","Contr√¥le d'int√©grit√© 8 types restaur√© (v1.6.1)","Boutons s√©lection dynamiques selon le filtre %","Bouton Recommencer d√©plac√© dans le header"]},{version:"1.9.3",date:"28 d√©cembre 2025",tag:null,color:"blue",title:"Onglet √Ä supprimer + Bouton flottant",items:["Renommage onglet Isol√©s ‚Üí √Ä supprimer avec filtrage strict","Bouton flottant pour actions rapides Fusionner/Supprimer","Tableau clusters avec d√©tails complets","Actions distinctes Fusionner vs Supprimer"]},{version:"1.9.2",date:"28 d√©cembre 2025",tag:null,color:"indigo",title:"Algorithme anti-faux-positifs",items:["Crit√®res suffisants obligatoires au-del√† du nom","Rejet des homonymes sans donn√©es confirmantes","Tracking des crit√®res validants par paire"]},{version:"1.8.6",date:"16 d√©cembre 2025",tag:null,color:"purple",title:"Corrections GEDCOM et g√©n√©ration HEAD/TRLR",items:["Gestion balises CONT/CONC multi-lignes","G√©n√©ration automatique HEAD/TRLR","Compatibilit√© GEDCOM 5.5.1"]},{version:"1.0.0",date:"1 d√©cembre 2025",tag:"INITIALE",color:"gray",title:"Version initiale",items:["Parseur GEDCOM complet","D√©tection intelligente avec Soundex fran√ßais","Syst√®me de scoring hybride 9 crit√®res","Fusion s√©curis√©e sans perte de donn√©es"]}],Fe={catherine:["katherine","cathrine","katrine","caterine"],jean:["jehan","johan","joan"],marie:["maria","mary","mari"],pierre:["peter","pedro","piere"],jacques:["james","jacob","jacque"],fran√ßois:["francis","francois","fransois"],louis:["lewis","luis","loui"],anne:["ann","anna","ane"],marguerite:["margaret","margueritte","margarite"],nicolas:["nicholas","nicola","nikolas"],guillaume:["william","guilaume","guillem"],antoine:["anthony","antoin","antonio"],michel:["michael","mickael","miguel"],philippe:["philip","filippe","philipe"],charles:["karl","carlo","charle"],henri:["henry","henrique","enrique"],joseph:["josef","giuseppe","jose"],paul:["paolo","pablo","paulus"],√©tienne:["estienne","stephen","esteban"],claude:["claudio","claudius"],jeanne:["johanna","jane","juana"],fran√ßoise:["francisca","frances"],madeleine:["magdalena","madeline"],elisabeth:["elizabeth","isabelle","isabel"],th√©r√®se:["theresa","teresa"],louise:["luisa","louisa"],suzanne:["susanna","susan"],h√©l√®ne:["helena","helen","elena"],victoire:["victoria","vittoria"],rose:["rosa","rosalie"],germaine:["germana"],l√©on:["leon","leone","leo"],augustin:["augustine","agustin"],marcel:["marcello","marcelo"],gabriel:["gabriele"],√©mile:["emilio","emil"],lucien:["luciano","lucianus"],fernand:["fernando","ferdinand"],raymond:["raimundo","raimond"],maurice:["mauricio","moritz"]},te=s=>{const t=s.toLowerCase().trim();for(const[a,l]of Object.entries(Fe))if(t===a||l.includes(t))return a;return t},ae=s=>{if(!s)return"";const t=s.toUpperCase().replace(/[^A-Z]/g,"");if(!t)return"";const a={B:1,F:1,P:1,V:1,C:2,G:2,J:2,K:2,Q:2,S:2,X:2,Z:2,D:3,T:3,L:4,M:5,N:5,R:6};let l=t[0],n=a[t[0]]||0;for(let c=1;c<t.length&&l.length<4;c++){const h=a[t[c]]||0;h&&h!==n?(l+=h,n=h):h||(n=0)}return l.padEnd(4,"0")},ze=s=>{const t=s.split(`
`),a=[],l=new Map;let n=null,c=null,h=null,m=null;return t.forEach(d=>{const i=d.trim();if(i.startsWith("2 CONT ")||i.startsWith("3 CONT ")){const r=i.replace(/^\d+ CONT /,"");n&&m&&(m==="NAME"&&n.names.length>0?n.names[n.names.length-1]+=`
`+r:m==="BIRT_PLAC"?n.birthPlace+=`
`+r:m==="DEAT_PLAC"&&(n.deathPlace+=`
`+r));return}if(i.startsWith("2 CONC ")||i.startsWith("3 CONC ")){const r=i.replace(/^\d+ CONC /,"");n&&m&&(m==="NAME"&&n.names.length>0?n.names[n.names.length-1]+=r:m==="BIRT_PLAC"?n.birthPlace+=r:m==="DEAT_PLAC"&&(n.deathPlace+=r));return}if(i.startsWith("0")&&i.includes("INDI")){n&&a.push(n);const r=i.match(/@([^@]+)@/);n={id:r?r[1]:i.split(" ")[1],names:[],birth:"",birthPlace:"",death:"",deathPlace:"",sex:"",parents:[],spouses:[],familyAsChild:null,familiesAsSpouse:[],occupation:"",religion:""},h=null,m=null}else if(i.startsWith("0")&&i.includes("FAM")){n&&(a.push(n),n=null);const r=i.match(/@([^@]+)@/),x=r?r[1]:i.split(" ")[1];c={id:x,husband:null,wife:null,children:[]},l.set(x,c),h=null}else if(i.startsWith("0"))n&&(a.push(n),n=null),c=null,h=null;else if(n){if(i.startsWith("1 NAME ")){const r=i.substring(7).replace(/\//g,"").trim();n.names.push(r),m="NAME"}else if(i.startsWith("1 SEX "))n.sex=i.substring(6).trim();else if(i.startsWith("1 BIRT"))h="BIRT",m="BIRT";else if(i.startsWith("1 DEAT"))h="DEAT",m="DEAT";else if(i.startsWith("1 OCCU "))n.occupation=i.substring(7).trim();else if(i.startsWith("1 RELI "))n.religion=i.substring(7).trim();else if(i.startsWith("1 FAMC ")){const r=i.match(/@([^@]+)@/);r&&(n.familyAsChild=r[1])}else if(i.startsWith("1 FAMS ")){const r=i.match(/@([^@]+)@/);r&&n.familiesAsSpouse.push(r[1])}else if(i.startsWith("2 DATE ")&&h){const r=i.substring(7).trim();h==="BIRT"?n.birth=r:h==="DEAT"&&(n.death=r)}else if(i.startsWith("2 PLAC ")&&h){let r=i.substring(7).trim();r=r.replace(/^\d{5}\s+/,""),h==="BIRT"?(n.birthPlace=r,m="BIRT_PLAC"):h==="DEAT"&&(n.deathPlace=r,m="DEAT_PLAC")}}else if(c){if(i.startsWith("1 HUSB ")){const r=i.match(/@([^@]+)@/);r&&(c.husband=r[1])}else if(i.startsWith("1 WIFE ")){const r=i.match(/@([^@]+)@/);r&&(c.wife=r[1])}else if(i.startsWith("1 CHIL ")){const r=i.match(/@([^@]+)@/);r&&c.children.push(r[1])}}}),n&&a.push(n),l.forEach((d,i)=>{if(d.children.forEach(r=>{const x=a.find(f=>f.id===r);x&&(d.husband&&x.parents.push(d.husband),d.wife&&x.parents.push(d.wife))}),d.husband&&d.wife){const r=a.find(f=>f.id===d.husband),x=a.find(f=>f.id===d.wife);r&&r.spouses.push(d.wife),x&&x.spouses.push(d.husband)}}),Ce(l),a},We=(s,t)=>{let a=0,l=0;const n=[],c=[];if(s.sex&&t.sex&&s.sex!==t.sex)return{score:0,details:["Sexe diff√©rent: √©liminatoire"],sufficientCriteria:[]};if(s.names[0]&&t.names[0]){l+=30;const i=s.names[0].toLowerCase().split(/\s+/),r=t.names[0].toLowerCase().split(/\s+/),x=i.map(te),f=r.map(te),P=i.map(ae).join(""),D=r.map(ae).join("");if(x.join(" ")===f.join(" "))a+=30,n.push("Nom identique: +30");else if(P===D)a+=25,n.push("Nom phon√©tiquement similaire: +25");else{const o=x.filter(g=>f.includes(g));if(o.length>0){const g=Math.round(o.length/Math.max(i.length,r.length)*20);a+=g,n.push(`Parties communes (${o.length}): +${g}`)}}}if(s.birth&&t.birth){l+=25;const i=s.birth.match(/\d{4}/)?.[0],r=t.birth.match(/\d{4}/)?.[0];if(i&&r){const x=Math.abs(parseInt(i)-parseInt(r));x===0?(a+=25,n.push("Ann√©e naissance identique: +25"),c.push("annee_naissance")):x<=2&&(a+=15,n.push(`Ann√©e naissance proche (¬±${x}): +15`),c.push("annee_naissance_proche"))}s.birth===t.birth&&s.birth.length>4&&(a+=5,n.push("Date naissance exacte: +5 bonus"),c.push("date_naissance_exacte"))}if(s.sex&&t.sex&&(l+=15,s.sex===t.sex&&(a+=15,n.push("Sexe identique: +15"))),s.parents.length>0&&t.parents.length>0){l+=20;const i=s.parents.filter(r=>t.parents.includes(r));if(i.length>0){const r=Math.min(20,i.length*10);a+=r,n.push(`Parents communs (${i.length}): +${r}`),c.push("parents_communs")}}const h=new Set,m=new Set;if(E.forEach(i=>{i.id!==s.id&&i.parents.some(r=>s.parents.includes(r))&&h.add(i.id),i.id!==t.id&&i.parents.some(r=>t.parents.includes(r))&&m.add(i.id)}),h.size>0&&m.size>0){l+=15;const i=[...h].filter(r=>m.has(r));i.length>0&&(a+=15,n.push(`Fratrie commune (${i.length}): +15`),c.push("fratrie_commune"))}if(s.birthPlace&&t.birthPlace){l+=10;const i=s.birthPlace.toLowerCase().replace(/[,\s]+/g," ").trim(),r=t.birthPlace.toLowerCase().replace(/[,\s]+/g," ").trim();i===r?(a+=10,n.push("Lieu naissance identique: +10"),c.push("lieu_naissance")):(i.includes(r)||r.includes(i))&&(a+=6,n.push("Lieu naissance similaire: +6"),c.push("lieu_naissance_similaire"))}if(s.spouses.length>0&&t.spouses.length>0){l+=8;const i=s.spouses.filter(r=>t.spouses.includes(r));i.length>0&&(a+=8,n.push(`Conjoints communs (${i.length}): +8`),c.push("conjoints_communs"))}if(s.death&&t.death){l+=15;const i=s.death.match(/\d{4}/)?.[0],r=t.death.match(/\d{4}/)?.[0];i&&r&&Math.abs(parseInt(i)-parseInt(r))<=2&&(a+=15,n.push("Ann√©e d√©c√®s proche: +15"),c.push("annee_deces"))}s.occupation&&t.occupation&&(l+=5,s.occupation.toLowerCase()===t.occupation.toLowerCase()&&(a+=5,n.push("Profession identique: +5"),c.push("profession")));const d=l>0?Math.round(a/l*100):0;return c.length===0&&d>0?{score:0,details:[...n,"‚ö†Ô∏è REJET√â: Aucun crit√®re suffisant"],sufficientCriteria:[]}:{score:d,details:n,sufficientCriteria:c}},qe=(s,t)=>{const a=[],l=[];let n=0,c=0;t.forEach((o,g)=>{o.children.forEach(b=>{const w=s.find(S=>S.id===b);w&&w.familyAsChild!==g&&l.push({type:"unidirectional_link",severity:"warning",personId:b,message:`${w?.names[0]||b}: Lien enfant‚Üífamille non bidirectionnel`})}),[o.husband,o.wife].forEach(b=>{if(b){const w=s.find(S=>S.id===b);w&&!w.familiesAsSpouse.includes(g)&&l.push({type:"unidirectional_link",severity:"warning",personId:b,message:`${w?.names[0]||b}: Lien conjoint‚Üífamille non bidirectionnel`})}})}),s.forEach(o=>{const g=o.birth?.match(/\d{4}/)?.[0],b=o.death?.match(/\d{4}/)?.[0];g&&b&&parseInt(g)>parseInt(b)&&a.push({type:"birth_after_death",severity:"critical",personId:o.id,message:`${o.names[0]||o.id}: Naissance (${g}) apr√®s d√©c√®s (${b})`}),o.parents.forEach(w=>{const S=s.find(L=>L.id===w);if(S){const L=S.birth?.match(/\d{4}/)?.[0];if(L&&g&&parseInt(L)>parseInt(g)&&a.push({type:"parent_after_child",severity:"critical",personId:o.id,message:`${o.names[0]||o.id}: Parent ${S.names[0]} n√© apr√®s enfant`}),L&&g){const Z=parseInt(g)-parseInt(L);Z<12?l.push({type:"age_gap_suspect",severity:"warning",personId:o.id,message:`${o.names[0]||o.id}: Parent ${S.names[0]} avait ${Z} ans √† la naissance`}):Z>80&&l.push({type:"age_gap_suspect",severity:"warning",personId:o.id,message:`${o.names[0]||o.id}: Parent ${S.names[0]} aurait eu ${Z} ans`})}}})});const h=(o,g=new Set,b=[])=>{if(g.has(o))return b.includes(o)?{hasLoop:!0,personId:o,path:b}:{hasLoop:!1};g.add(o),b.push(o);const w=s.find(S=>S.id===o);if(w)for(const S of w.parents){const L=h(S,g,[...b]);if(L.hasLoop)return L}return{hasLoop:!1}};s.slice(0,100).forEach(o=>{h(o.id).hasLoop&&a.push({type:"genealogical_loop",severity:"critical",personId:o.id,message:`${o.names[0]||o.id}: Boucle g√©n√©alogique d√©tect√©e (anc√™tre de soi-m√™me)`})});const m=ce.split(`
`);let d=0;m.forEach((o,g)=>{const b=o.trim().match(/^(\d+)/);if(b){const w=parseInt(b[1]);w>d+1&&l.push({type:"structure_error",severity:"warning",line:g+1,message:`Ligne ${g+1}: Saut de niveau GEDCOM (${d} ‚Üí ${w})`}),d=w}});const i=new Set(s.map(o=>o.id));t.forEach(o=>i.add(o.id));const r=/@([^@]+)@/g;let x;m.forEach((o,g)=>{for(;(x=r.exec(o))!==null;){const b=x[1];!i.has(b)&&!o.includes("0 @")&&a.push({type:"orphan_reference",severity:"critical",line:g+1,message:`Ligne ${g+1}: R√©f√©rence orpheline @${b}@`})}});const f=new Map;s.forEach(o=>f.set(o.id,(f.get(o.id)||0)+1)),f.forEach((o,g)=>{o>1&&a.push({type:"duplicate_id",severity:"critical",personId:g,message:`ID @${g}@ utilis√© ${o} fois`})});const P=s.filter(o=>o.parents.length===0&&o.spouses.length===0&&o.familiesAsSpouse.length===0).length;s.forEach(o=>{o.birth&&(n+=2),c+=2,o.death&&(n+=2),c+=2,o.parents.length>0&&(n+=3),c+=3,o.spouses.length>0&&(n+=2),c+=2,o.familiesAsSpouse.length>0&&(n+=1),c+=1});const D=c>0?Math.round(n/c*100):0;return{errors:a,warnings:l,stats:{totalIndividuals:s.length,totalFamilies:t.size,isolatedCount:P,completenessPercent:D,errorCount:a.length,warningCount:l.length}}},Be=s=>{const t=[],a=new Map,l=new Map,n=new Map;let c=0,h=0;s.forEach(d=>{if(d.names[0]){const f=d.names[0].toLowerCase().split(/\s+/).map(te).map(ae).join("-");a.has(f)||a.set(f,[]),a.get(f).push(d)}const i=d.birth?.match(/\d{4}/)?.[0];i&&[-2,-1,0,1,2].forEach(r=>{const x=String(parseInt(i)+r);l.has(x)||l.set(x,new Set),l.get(x).add(d.id)}),d.parents.forEach(r=>{n.has(r)||n.set(r,[]),n.get(r).push(d)})});for(let d=0;d<s.length;d++){const i=s[d];for(let r=d+1;r<s.length;r++){const x=s[r];h++;const f=[i.id,x.id].sort().join("-");if(!(()=>{if(i.sex&&x.sex&&i.sex!==x.sex)return c++,!1;const o=i.birth?.match(/\d{4}/)?.[0],g=x.birth?.match(/\d{4}/)?.[0];return o&&g&&Math.abs(parseInt(o)-parseInt(g))>5?(c++,!1):!0})())continue;const D=We(i,x);D.score>=80&&t.push({person1:i,person2:x,similarity:Math.round(D.score),details:D.details,sufficientCriteria:D.sufficientCriteria,id:f})}if(d%100===0){const r=Math.round(d/s.length*100);I(30+r*.65)}}console.log(`Optimisation: ${h} comparaisons (${c} skipped)`);const m=t.sort((d,i)=>i.similarity-d.similarity);return Ue(m,s),m},Ue=(s,t)=>{const a=new Map,l=new Set,n=[];s.forEach(h=>{const m=h.person1.id,d=h.person2.id;a.has(m)||a.set(m,new Set),a.has(d)||a.set(d,new Set),a.get(m).add(d),a.get(d).add(m)});const c=(h,m)=>{if(l.has(h))return;l.add(h),m.add(h),(a.get(h)||new Set).forEach(i=>c(i,m))};a.forEach((h,m)=>{if(!l.has(m)){const d=new Set;if(c(m,d),d.size>2){const i=Array.from(d),r=i.map(x=>t.find(f=>f.id===x)).filter(x=>x!=null);if(r.length>2){const x=s.filter(P=>i.includes(P.person1.id)&&i.includes(P.person2.id)),f=x.length>0?Math.round(x.reduce((P,D)=>P+D.similarity,0)/x.length):0;n.push({ids:i,size:r.length,people:r,avgScore:f})}}}}),console.log("Clusters d√©tect√©s:",n.length,n),ge(n)},Ge=s=>{const t=s.filter(a=>{const l=!a.names[0]||a.names[0].trim()===""||a.names[0].trim()==="?",n=a.parents.length===0&&a.spouses.length===0&&a.familiesAsSpouse.length===0;return l||n});Ne(t)},He=(s,t)=>{const a=[],l=new Map;s.forEach(n=>{if(n.names[0]){const c=n.names[0].toLowerCase().split(/\s+/),h=c[c.length-1];l.has(h)||l.set(h,[]),l.get(h).push(n)}}),l.forEach((n,c)=>{if(n.length>=3){const h=new Map;n.forEach(m=>{const d=m.birth?.match(/\d{4}/)?.[0];if(d){const i=Math.floor(parseInt(d)/10)*10;h.has(i)||h.set(i,[]),h.get(i).push(m)}}),h.forEach((m,d)=>{if(m.length>=3){const i=Math.min(95,60+m.length*5);a.push({type:"name_period_cluster",lastName:c,decade:d,people:m,confidence:i,reason:`${m.length} personnes nomm√©es "${c}" n√©es dans les ann√©es ${d}`})}})}}),ve(a.sort((n,c)=>c.confidence-n.confidence))},Ve=s=>{const t=new Set(N);p.forEach(a=>{s.includes(a.person1.id)&&s.includes(a.person2.id)&&t.add(a.id)}),k(t)},Ke=s=>{const t=new Set(se);t.has(s)?t.delete(s):t.add(s),fe(t)},z=s=>{let t=0;return s.names[0]?.length>5&&(t+=10),s.birth&&(t+=8),s.death&&(t+=6),s.sex&&(t+=4),s.birthPlace&&(t+=7),s.deathPlace&&(t+=5),t+=s.parents.length*6,t+=s.spouses.length*5,s.occupation&&(t+=4),s.familyAsChild&&(t+=3),t+=s.familiesAsSpouse.length*3,t},Je=s=>ee(s),ne=()=>ee(null),Pe=s=>{const t=new Set(N);t.has(s)?t.delete(s):t.add(s),k(t)},Ye=()=>{const s=p.filter(t=>t.similarity>=M).map(t=>t.id);k(new Set(s))},Ze=()=>{const s=new Set;U.forEach((t,a)=>{t.avgScore>=F&&s.add(a)}),ye(s)},Qe=s=>s.avgScore||0,ie=()=>U.filter(s=>Qe(s)>=F),J=s=>E.find(a=>a.id===s)?.names[0]||s,Xe=s=>{const t=s.target.files[0];if(t){v(t),I(10);const a=new FileReader;a.onload=l=>{I(20);const n=l.target.result;oe(n);const c=ze(n);I(30),C(c);const h=qe(c,Me);we(h);const m=Be(c);y(m),Ge(c),He(c),I(100),setTimeout(()=>X("review"),500)},a.readAsText(t)}},es=()=>{const s=new Map;N.forEach(a=>{const l=p.find(n=>n.id===a);if(l){const n=z(l.person1),c=z(l.person2);n>=c?s.set(l.person2.id,l.person1.id):s.set(l.person1.id,l.person2.id)}}),he(s);const t=E.length-s.size-A.size;me({mergedCount:s.size,deletedCount:A.size,remainingCount:t}),X("complete")},ss=()=>{const s=ce.split(`
`),t=new Set([...de.keys(),...A]),a=de,l=[];let n=!1,c=!1;s.forEach(i=>{i.trim().startsWith("0 HEAD")&&(c=!0),i.trim().startsWith("0 TRLR")}),c||(l.push("0 HEAD"),l.push("1 SOUR Fusionneur GEDCOM"),l.push("1 GEDC"),l.push("2 VERS 5.5.1"),l.push("1 CHAR UTF-8"),l.push("1 DATE "+new Date().toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}).toUpperCase()));for(const i of s){const r=i.trim();if(r.startsWith("0 TRLR"))continue;if(r.startsWith("0 ")){n=!1;const f=r.match(/@([^@]+)@/);if(f&&t.has(f[1])){n=!0;continue}}if(n)continue;let x=i;a.forEach((f,P)=>{x=x.replace(new RegExp("@"+P+"@","g"),"@"+f+"@")}),l.push(x)}l.push("0 TRLR");const h=new Blob([l.join(`
`)],{type:"text/plain"}),m=URL.createObjectURL(h),d=document.createElement("a");d.href=m,d.download="gedcom_nettoye_"+new Date().toISOString().slice(0,10)+".ged",document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(m)},Ae=()=>{X("upload"),C([]),y([]),k(new Set),oe(""),xe(""),ue(80),I(0),je("clusters"),be(80),ye(new Set),ge([]),fe(new Set),Ne([]),H(new Set),ve([]),we(null),v(null),he(new Map),me(null),ee(null),Ce(new Map),K(!1)},ts=()=>p.filter(s=>s.similarity>=M&&(!B||s.person1.names.some(t=>t.toLowerCase().includes(B.toLowerCase()))||s.person2.names.some(t=>t.toLowerCase().includes(B.toLowerCase())))),Y=()=>{const s=new Set;return U.forEach(t=>t.ids.forEach(a=>s.add(a))),ts().filter(t=>!s.has(t.person1.id)&&!s.has(t.person2.id))};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-emerald-50 via-white to-teal-50",children:[e.jsx("div",{className:"bg-gradient-to-r from-emerald-600 to-teal-600 text-white px-4 py-4 shadow-lg",children:e.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(is,{className:"w-8 h-8"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold",children:"Fusionneur GEDCOM"}),e.jsxs("p",{className:"text-emerald-100 text-sm",children:["v",Se," - Contr√¥le int√©grit√© avanc√©"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[q!=="upload"&&e.jsxs("button",{onClick:Ae,className:"flex items-center gap-2 px-3 py-2 bg-white/20 hover:bg-white/30 rounded-lg transition-colors",children:[e.jsx(rs,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Recommencer"})]}),u&&e.jsxs("button",{onClick:()=>K(!0),className:`flex items-center gap-2 px-3 py-2 rounded-lg transition-colors ${u.stats.errorCount>0?"bg-red-500 hover:bg-red-600":u.stats.warningCount>0?"bg-yellow-500 hover:bg-yellow-600":"bg-green-500 hover:bg-green-600"}`,children:[e.jsx(De,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Int√©grit√©"}),u.stats.errorCount+u.stats.warningCount>0&&e.jsx("span",{className:"px-1.5 py-0.5 bg-white/30 rounded text-xs font-bold",children:u.stats.errorCount+u.stats.warningCount})]}),e.jsxs("button",{onClick:()=>pe(!0),className:"flex items-center gap-2 px-3 py-2 bg-white/20 hover:bg-white/30 rounded-lg transition-colors",children:[e.jsx(Le,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Nouveaut√©s"})]})]})]})}),G>0&&G<100&&e.jsx("div",{className:"bg-white border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-2",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-emerald-500 h-2 rounded-full transition-all duration-300",style:{width:G+"%"}})}),e.jsxs("span",{className:"text-sm text-gray-600",children:[G,"%"]})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto p-4",children:[q==="upload"&&e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 max-w-lg w-full text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(Re,{className:"w-10 h-10 text-emerald-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Charger votre fichier GEDCOM"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"S√©lectionnez un fichier .ged export√© depuis MyHeritage, Geneanet, ou autre logiciel de g√©n√©alogie."}),e.jsxs("label",{className:"block",children:[e.jsx("input",{type:"file",accept:".ged,.gedcom",onChange:Xe,className:"hidden"}),e.jsxs("span",{className:"inline-flex items-center gap-2 px-6 py-3 bg-emerald-600 text-white rounded-xl cursor-pointer hover:bg-emerald-700 transition-colors font-medium",children:[e.jsx(Re,{className:"w-5 h-5"}),"S√©lectionner un fichier"]})]}),e.jsxs("p",{className:"text-xs text-gray-400 mt-4",children:["v",Se," - Contr√¥le d'int√©grit√© 8 types + Bouton flottant"]})]})}),q==="review"&&e.jsxs("div",{children:[u&&u.errors.length>0&&e.jsxs("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:[e.jsxs("h3",{className:"font-semibold text-red-800 flex items-center gap-2",children:[e.jsx(W,{className:"w-5 h-5"}),u.errors.length," erreur(s) critique(s) d√©tect√©e(s)"]}),e.jsxs("ul",{className:"mt-2 text-sm text-red-700",children:[u.errors.slice(0,3).map((s,t)=>e.jsxs("li",{children:["‚Ä¢ ",s.message]},t)),u.errors.length>3&&e.jsxs("li",{className:"italic",children:["... et ",u.errors.length-3," autre(s)"]})]}),e.jsx("button",{onClick:()=>K(!0),className:"mt-2 text-sm text-red-600 hover:text-red-800 underline",children:"Voir le rapport complet"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3 mb-6",children:[e.jsxs("div",{className:"bg-white rounded-xl p-4 shadow border",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-800",children:E.length}),e.jsx("div",{className:"text-sm text-gray-500",children:"Individus"})]}),e.jsxs("div",{className:"bg-white rounded-xl p-4 shadow border",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:U.length}),e.jsx("div",{className:"text-sm text-gray-500",children:"Clusters"})]}),e.jsxs("div",{className:"bg-white rounded-xl p-4 shadow border",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:Y().length}),e.jsx("div",{className:"text-sm text-gray-500",children:"Doublons"})]}),e.jsxs("div",{className:"bg-white rounded-xl p-4 shadow border",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:_.length}),e.jsx("div",{className:"text-sm text-gray-500",children:"√Ä supprimer"})]}),e.jsxs("div",{className:"bg-white rounded-xl p-4 shadow border",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:V.length}),e.jsx("div",{className:"text-sm text-gray-500",children:"Suggestions IA"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border overflow-hidden",children:[e.jsx("div",{className:"flex border-b",children:[{id:"clusters",label:"Clusters",icon:"üü†",count:ie().length},{id:"pairs",label:"Doublons",icon:"üîµ",count:Y().length},{id:"toDelete",label:"√Ä supprimer",icon:"üóëÔ∏è",count:_.length},{id:"ai",label:"Suggestions IA",icon:"üü£",count:V.length}].map(s=>e.jsxs("button",{onClick:()=>je(s.id),className:`flex-1 px-4 py-3 text-sm font-medium transition-colors ${O===s.id?"bg-emerald-50 text-emerald-700 border-b-2 border-emerald-500":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[e.jsx("span",{className:"mr-1",children:s.icon}),e.jsx("span",{className:"hidden sm:inline",children:s.label}),e.jsx("span",{className:"ml-1 px-2 py-0.5 bg-gray-100 rounded-full text-xs",children:s.count})]},s.id))}),e.jsxs("div",{className:"p-4",children:[O==="clusters"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap gap-3 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Score min:"}),e.jsx("input",{type:"range",min:"80",max:"100",value:F,onChange:s=>be(parseInt(s.target.value)),className:"w-24"}),e.jsxs("span",{className:"text-sm font-medium",children:[F,"%"]})]}),e.jsxs("button",{onClick:Ze,className:"px-3 py-1 bg-indigo-600 text-white text-sm rounded-lg hover:bg-indigo-700",children:["S√©lectionner ‚â•",F,"%"]})]}),ie().length===0?e.jsx("p",{className:"text-center text-gray-500 py-8",children:"Aucun cluster trouv√© avec ce filtre"}):e.jsx("div",{className:"space-y-3",children:ie().map((s,t)=>e.jsxs("div",{className:`border rounded-lg p-3 ${ke.has(t)?"border-indigo-500 bg-indigo-50":"border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"font-medium",children:[s.size," personnes"]}),e.jsxs("span",{className:`px-2 py-0.5 rounded text-sm ${s.avgScore>=95?"bg-green-100 text-green-800":s.avgScore>=90?"bg-yellow-100 text-yellow-800":"bg-orange-100 text-orange-800"}`,children:["Score: ",s.avgScore,"%"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>Ke(t),className:"px-3 py-1 text-sm bg-gray-100 rounded hover:bg-gray-200 flex items-center gap-1",children:se.has(t)?e.jsxs(e.Fragment,{children:["R√©duire ",e.jsx(ls,{className:"w-4 h-4"})]}):e.jsxs(e.Fragment,{children:["D√©tails ",e.jsx(cs,{className:"w-4 h-4"})]})}),e.jsx("button",{onClick:()=>Ve(s.ids),className:"px-3 py-1 text-sm bg-emerald-600 text-white rounded hover:bg-emerald-700",children:"S√©lectionner"})]})]}),se.has(t)&&e.jsx("div",{className:"mt-3 pt-3 border-t",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-1 text-left font-medium text-gray-900",children:"#"}),e.jsx("th",{className:"px-2 py-1 text-left font-medium text-gray-900",children:"Nom complet"}),e.jsx("th",{className:"px-2 py-1 text-left font-medium text-gray-900",children:"Naissance"}),e.jsx("th",{className:"px-2 py-1 text-left font-medium text-gray-900",children:"Lieu naiss."}),e.jsx("th",{className:"px-2 py-1 text-left font-medium text-gray-900",children:"D√©c√®s"}),e.jsx("th",{className:"px-2 py-1 text-left font-medium text-gray-900",children:"Sexe"}),e.jsx("th",{className:"px-2 py-1 text-left font-medium text-gray-900",children:"Parents"}),e.jsx("th",{className:"px-2 py-1 text-left font-medium text-gray-900",children:"Conjoints"}),e.jsx("th",{className:"px-2 py-1 text-left font-medium text-gray-900",children:"ID"})]})}),e.jsx("tbody",{children:s.people.map((a,l)=>e.jsxs("tr",{className:l%2===0?"bg-white":"bg-gray-50",children:[e.jsx("td",{className:"px-2 py-1 text-gray-900",children:l+1}),e.jsx("td",{className:"px-2 py-1 font-medium text-gray-900",children:a.names[0]||"Sans nom"}),e.jsx("td",{className:"px-2 py-1 text-gray-900",children:a.birth||"-"}),e.jsx("td",{className:"px-2 py-1 text-gray-900 text-xs",children:a.birthPlace||"-"}),e.jsx("td",{className:"px-2 py-1 text-gray-900",children:a.death||"-"}),e.jsx("td",{className:"px-2 py-1 text-gray-900",children:a.sex||"-"}),e.jsx("td",{className:"px-2 py-1 text-gray-900 text-xs",children:a.parents.length>0?a.parents.map(n=>E.find(h=>h.id===n)?.names[0]?.split(" ")[0]||n).join(", "):"-"}),e.jsx("td",{className:"px-2 py-1 text-gray-900 text-xs",children:a.spouses.length>0?a.spouses.map(n=>E.find(h=>h.id===n)?.names[0]?.split(" ")[0]||n).join(", "):"-"}),e.jsx("td",{className:"px-2 py-1 font-mono text-xs text-gray-500",children:a.id})]},a.id))})]})})})]},t))})]}),O==="pairs"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap gap-3 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Score min:"}),e.jsx("input",{type:"range",min:"80",max:"100",value:M,onChange:s=>ue(parseInt(s.target.value)),className:"w-24"}),e.jsxs("span",{className:"text-sm font-medium",children:[M,"%"]})]}),e.jsxs("button",{onClick:Ye,className:"px-3 py-1 bg-indigo-600 text-white text-sm rounded-lg hover:bg-indigo-700",children:["S√©lectionner ‚â•",M,"%"]}),e.jsx("button",{onClick:()=>k(new Set),className:"px-3 py-1 bg-gray-200 text-gray-700 text-sm rounded-lg hover:bg-gray-300",children:"D√©s√©lectionner tout"})]}),e.jsx("input",{type:"text",placeholder:"Rechercher par nom...",value:B,onChange:s=>xe(s.target.value),className:"w-full px-3 py-2 border rounded-lg mb-4"}),Y().length===0?e.jsx("p",{className:"text-center text-gray-500 py-8",children:"Aucun doublon simple trouv√©"}):e.jsx("div",{className:"space-y-3",children:Y().slice(0,50).map(s=>e.jsxs("div",{className:`border rounded-lg p-3 cursor-pointer transition-colors ${N.has(s.id)?"border-emerald-500 bg-emerald-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>Pe(s.id),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:`px-2 py-0.5 rounded text-sm font-medium ${s.similarity>=95?"bg-green-100 text-green-800":s.similarity>=90?"bg-yellow-100 text-yellow-800":"bg-orange-100 text-orange-800"}`,children:[s.similarity,"%"]}),e.jsx("button",{onClick:t=>{t.stopPropagation(),Je(s)},className:"text-sm text-blue-600 hover:text-blue-800",children:"Pr√©visualiser"})]}),e.jsx("div",{className:"grid md:grid-cols-2 gap-3",children:[s.person1,s.person2].map((t,a)=>e.jsxs("div",{className:"bg-gray-50 rounded p-2",children:[e.jsx("div",{className:"font-medium text-gray-900",children:t.names[0]||"Sans nom"}),e.jsxs("div",{className:"text-sm text-gray-600",children:[t.birth&&e.jsxs("span",{children:["N√©(e): ",t.birth]}),t.birthPlace&&e.jsxs("span",{children:[" ‚Ä¢ ",t.birthPlace]})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[t.death&&e.jsxs("span",{children:["D√©c√®s: ",t.death]}),t.deathPlace&&e.jsxs("span",{children:[" ‚Ä¢ ",t.deathPlace]})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Sexe: ",t.sex||"-"]}),t.parents.length>0&&e.jsxs("div",{className:"text-sm text-gray-600",children:["Parents: ",t.parents.map(l=>J(l)).join(", ")]}),e.jsx("div",{className:"text-xs text-gray-400 font-mono",children:t.id})]},a))}),s.sufficientCriteria&&s.sufficientCriteria.length>0&&e.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:["Crit√®res validants: ",s.sufficientCriteria.join(", ")]})]},s.id))})]}),O==="toDelete"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsxs("button",{onClick:()=>H(new Set(_.map(s=>s.id))),className:"px-3 py-1 bg-red-600 text-white text-sm rounded-lg hover:bg-red-700",children:["Tout s√©lectionner (",_.length,")"]}),e.jsx("button",{onClick:()=>H(new Set),className:"px-3 py-1 bg-gray-200 text-gray-700 text-sm rounded-lg hover:bg-gray-300",children:"D√©s√©lectionner tout"})]}),_.length===0?e.jsx("p",{className:"text-center text-gray-500 py-8",children:"Aucune personne √† supprimer"}):e.jsx("div",{className:"space-y-2",children:_.map(s=>e.jsxs("div",{onClick:()=>{const t=new Set(A);t.has(s.id)?t.delete(s.id):t.add(s.id),H(t)},className:`flex items-center gap-3 p-3 rounded-lg border cursor-pointer transition-colors ${A.has(s.id)?"border-red-500 bg-red-50":"border-gray-200 hover:bg-gray-50"}`,children:[e.jsx("input",{type:"checkbox",checked:A.has(s.id),onChange:()=>{},className:"w-4 h-4 text-red-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-900",children:s.names[0]||e.jsx("span",{className:"italic text-gray-400",children:"Sans nom"})}),e.jsxs("div",{className:"text-sm text-gray-600",children:[s.birth||"Date inconnue"," ‚Ä¢ ",s.sex||"?"," ‚Ä¢ ",s.id]})]}),e.jsx(os,{className:"w-4 h-4 text-red-400"})]},s.id))})]}),O==="ai"&&e.jsx("div",{children:V.length===0?e.jsx("p",{className:"text-center text-gray-500 py-8",children:"Aucune suggestion IA disponible"}):e.jsx("div",{className:"space-y-4",children:V.map((s,t)=>e.jsxs("div",{className:"border rounded-lg p-4 bg-purple-50 border-purple-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ds,{className:"w-5 h-5 text-purple-600"}),e.jsx("span",{className:"font-medium text-purple-900",children:s.reason})]}),e.jsxs("span",{className:`px-2 py-0.5 rounded text-sm font-medium ${s.confidence>=85?"bg-green-100 text-green-800":s.confidence>=70?"bg-yellow-100 text-yellow-800":"bg-orange-100 text-orange-800"}`,children:["Confiance: ",s.confidence,"%"]})]}),e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:s.people.map((a,l)=>e.jsxs("div",{className:"p-3 bg-white rounded border hover:bg-purple-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"w-2 h-2 bg-purple-400 rounded-full"}),e.jsx("span",{className:"font-bold text-gray-900",children:a.names[0]||"Sans nom"}),e.jsx("span",{className:"text-xs text-gray-400 font-mono",children:a.id})]}),e.jsxs("div",{className:"ml-4 space-y-1 text-sm text-gray-900",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Naissance:"})," ",a.birth||"-",a.birthPlace&&e.jsxs("span",{children:[" ‚Ä¢ ",a.birthPlace]})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"D√©c√®s:"})," ",a.death||"-",a.deathPlace&&e.jsxs("span",{children:[" ‚Ä¢ ",a.deathPlace]})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Sexe:"})," ",a.sex||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Parents:"})," ",a.parents.length>0?a.parents.map(n=>J(n)).join(", "):"-"]})]})]},l))})]},t))})})]})]}),(N.size>0||A.size>0)&&e.jsx("div",{className:"fixed bottom-6 right-6 z-50",children:e.jsxs("button",{onClick:es,className:"flex items-center gap-2 px-6 py-3 bg-emerald-600 text-white rounded-full shadow-lg hover:bg-emerald-700 transition-all hover:scale-105",children:[e.jsx(re,{className:"w-5 h-5"}),N.size>0&&A.size>0?`Fusionner (${N.size}) + Supprimer (${A.size})`:N.size>0?`Fusionner ${N.size} doublon(s)`:`Supprimer ${A.size} personne(s)`]})})]}),q==="complete"&&$&&e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 max-w-lg w-full text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(re,{className:"w-10 h-10 text-emerald-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Traitement termin√© !"}),e.jsx("div",{className:"bg-gray-50 rounded-xl p-4 mb-6",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:$.mergedCount+$.deletedCount}),e.jsx("div",{className:"text-sm text-gray-500",children:$.mergedCount>0&&$.deletedCount>0?"Fusionn√©s + Supprim√©s":$.mergedCount>0?"Fusionn√©s":"Supprim√©s"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-emerald-600",children:$.remainingCount}),e.jsx("div",{className:"text-sm text-gray-500",children:"Restants"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:E.length}),e.jsx("div",{className:"text-sm text-gray-500",children:"Original"})]})]})}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("button",{onClick:ss,className:"w-full px-4 py-3 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 font-medium flex items-center justify-center gap-2",children:[e.jsx(hs,{className:"w-5 h-5"}),"T√©l√©charger le fichier nettoy√©"]}),e.jsx("button",{onClick:Ae,className:"w-full px-4 py-3 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"Traiter un autre fichier"})]})]})})]}),_e&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl max-w-2xl w-full max-h-[80vh] overflow-hidden shadow-2xl",children:[e.jsx("div",{className:"sticky top-0 bg-gradient-to-r from-emerald-600 to-teal-600 text-white px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2",children:[e.jsx(Le,{className:"w-6 h-6"}),"Historique des versions"]}),e.jsx("button",{onClick:()=>pe(!1),className:"p-2 hover:bg-white/20 rounded-lg",children:"‚úï"})]})}),e.jsx("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:Ee.map((s,t)=>e.jsxs("div",{className:`mb-6 pb-6 ${t<Ee.length-1?"border-b":""}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-medium bg-${s.color}-100 text-${s.color}-800`,children:["v",s.version]}),s.tag&&e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-bold ${s.tag==="ACTUELLE"?"bg-green-500 text-white":"bg-gray-200 text-gray-700"}`,children:s.tag}),e.jsx("span",{className:"text-sm text-gray-500",children:s.date})]}),e.jsx("h3",{className:"font-medium text-gray-800 mb-2",children:s.title}),e.jsx("ul",{className:"space-y-1",children:s.items.map((a,l)=>e.jsxs("li",{className:"text-sm text-gray-600 flex items-start gap-2",children:[e.jsx("span",{className:"text-emerald-500",children:"‚Ä¢"}),a]},l))})]},t))})]})}),Oe&&u&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl max-w-3xl w-full max-h-[85vh] overflow-hidden shadow-2xl",children:[e.jsx("div",{className:`sticky top-0 px-6 py-4 ${u.stats.errorCount>0?"bg-gradient-to-r from-red-600 to-red-500":u.stats.warningCount>0?"bg-gradient-to-r from-yellow-500 to-yellow-400":"bg-gradient-to-r from-green-600 to-green-500"} text-white`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2",children:[e.jsx(De,{className:"w-6 h-6"}),"Rapport d'int√©grit√© GEDCOM"]}),e.jsx("button",{onClick:()=>K(!1),className:"p-2 hover:bg-white/20 rounded-lg",children:"‚úï"})]})}),e.jsxs("div",{className:"p-6 overflow-y-auto max-h-[70vh]",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-800",children:u.stats.totalIndividuals}),e.jsx("div",{className:"text-xs text-gray-500",children:"Individus"})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-800",children:u.stats.totalFamilies}),e.jsx("div",{className:"text-xs text-gray-500",children:"Familles"})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[u.stats.completenessPercent,"%"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Compl√©tude"})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-600",children:u.stats.isolatedCount}),e.jsx("div",{className:"text-xs text-gray-500",children:"Isol√©s"})]})]}),e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsx("div",{className:`flex-1 p-3 rounded-lg ${u.stats.errorCount>0?"bg-red-50 border border-red-200":"bg-green-50 border border-green-200"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:`w-5 h-5 ${u.stats.errorCount>0?"text-red-600":"text-green-600"}`}),e.jsxs("span",{className:`font-medium ${u.stats.errorCount>0?"text-red-800":"text-green-800"}`,children:[u.stats.errorCount," erreur(s) critique(s)"]})]})}),e.jsx("div",{className:`flex-1 p-3 rounded-lg ${u.stats.warningCount>0?"bg-yellow-50 border border-yellow-200":"bg-green-50 border border-green-200"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:`w-5 h-5 ${u.stats.warningCount>0?"text-yellow-600":"text-green-600"}`}),e.jsxs("span",{className:`font-medium ${u.stats.warningCount>0?"text-yellow-800":"text-green-800"}`,children:[u.stats.warningCount," avertissement(s)"]})]})})]}),u.errors.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"font-semibold text-red-800 mb-3 flex items-center gap-2",children:[e.jsx(W,{className:"w-5 h-5"}),"Erreurs critiques"]}),e.jsxs("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:[u.errors.slice(0,20).map((s,t)=>e.jsxs("div",{className:"p-2 bg-red-50 border border-red-200 rounded text-sm text-red-700",children:[e.jsxs("span",{className:"font-medium",children:["[",s.type,"]"]})," ",s.message]},t)),u.errors.length>20&&e.jsxs("p",{className:"text-sm text-red-600 italic",children:["... et ",u.errors.length-20," autre(s) erreur(s)"]})]})]}),u.warnings.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-yellow-800 mb-3 flex items-center gap-2",children:[e.jsx(W,{className:"w-5 h-5"}),"Avertissements"]}),e.jsxs("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:[u.warnings.slice(0,20).map((s,t)=>e.jsxs("div",{className:"p-2 bg-yellow-50 border border-yellow-200 rounded text-sm text-yellow-700",children:[e.jsxs("span",{className:"font-medium",children:["[",s.type,"]"]})," ",s.message]},t)),u.warnings.length>20&&e.jsxs("p",{className:"text-sm text-yellow-600 italic",children:["... et ",u.warnings.length-20," autre(s) avertissement(s)"]})]})]}),u.errors.length===0&&u.warnings.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(re,{className:"w-16 h-16 text-green-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-medium text-green-800",children:"Fichier valide !"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Aucune erreur ni avertissement d√©tect√©."})]})]})]})}),R&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden shadow-2xl",children:[e.jsx("div",{className:"sticky top-0 bg-gradient-to-r from-blue-600 to-indigo-600 text-white px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Pr√©visualisation de la fusion"}),e.jsx("button",{onClick:ne,className:"p-2 hover:bg-white/20 rounded-lg",children:"‚úï"})]})}),e.jsxs("div",{className:"p-6 overflow-y-auto max-h-[75vh]",children:[e.jsx("div",{className:"grid md:grid-cols-2 gap-6",children:[R.person1,R.person2].map((s,t)=>{const a=z(s),l=z(R.person1)>=z(R.person2)?t===0:t===1;return e.jsxs("div",{className:`border-2 rounded-xl p-4 ${l?"border-green-500 bg-green-50":"border-gray-200"}`,children:[l&&e.jsx("div",{className:"mb-2 px-2 py-1 bg-green-500 text-white text-xs font-medium rounded w-fit",children:"CONSERV√â"}),e.jsx("h3",{className:"font-bold text-lg mb-3",children:s.names[0]||"Sans nom"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"ID:"})," ",s.id]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Naissance:"})," ",s.birth||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Lieu naissance:"})," ",s.birthPlace||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"D√©c√®s:"})," ",s.death||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Lieu d√©c√®s:"})," ",s.deathPlace||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Sexe:"})," ",s.sex||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Parents:"})," ",s.parents.map(n=>J(n)).join(", ")||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Conjoints:"})," ",s.spouses.map(n=>J(n)).join(", ")||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Profession:"})," ",s.occupation||"-"]})]}),e.jsx("div",{className:"mt-3 pt-3 border-t",children:e.jsxs("div",{className:"text-sm text-gray-600",children:["Score qualit√©: ",e.jsx("strong",{children:a})]})})]},t)})}),e.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[e.jsx("button",{onClick:ne,className:"px-4 py-2 bg-gray-200 rounded-lg hover:bg-gray-300",children:"Fermer"}),e.jsx("button",{onClick:()=>{Pe(R.id),ne()},className:`px-4 py-2 rounded-lg ${N.has(R.id)?"bg-red-600 text-white hover:bg-red-700":"bg-emerald-600 text-white hover:bg-emerald-700"}`,children:N.has(R.id)?"D√©s√©lectionner":"S√©lectionner pour fusion"})]})]})]})})]})};le.createRoot(document.getElementById("root")).render(e.jsx(ns.StrictMode,{children:e.jsx(js,{})}));
